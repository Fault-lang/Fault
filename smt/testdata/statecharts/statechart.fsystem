system statechart;

import "../simple.fspec";

global fl = new simple.fl;

component drain = states{
    initial: func{
        if !fl.active {
            fl.active = true;
            advance(this.open);
        }
    },
    open: func{
        if fl.vault.value < 0 {
            advance(this.close);
        }
    },
    close: func{
        fl.active = false;
    },
};

start { 
    drain: initial,
};

for 2 run {
    if !drain.close{
        fl.fn;
    }
}